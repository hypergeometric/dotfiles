#!/bin/bash

for i in $(find . -type d -depth 1); do
  ( cd $i
    RES=$(git status | grep -E '^(Changes|Changed|Untracked)')
    STAT=()
    grep -e 'Untracked' <<<${RES} >/dev/null 2>&1
    if [ $? -eq 0 ] ; then
      STAT+=("[Untracked]")
    fi
    grep -e 'Changed' <<<${RES} >/dev/null 2>&1
    if [ $? -eq 0 ] ; then
      STAT+=("[Modified]")
    fi
    grep -e 'Changes' <<<${RES} >/dev/null 2>&1
    if [ $? -eq 0 ] ; then
      STAT+=("[Staged]")
    fi

    if [ -n "$STAT" ] ; then
      (IFS=' '; echo "$i ${STAT[*]}")
    fi
  )
done
